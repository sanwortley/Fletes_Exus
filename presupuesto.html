<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Calcular presupuesto — Fletes Larga Distancia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --primary:#ffcc00;
      --bg:#000;
      --text:#fff;
      --muted:#bbb;
      --card:#111;
      --line:#222;
      --radius:16px;
      --shadow:0 8px 24px rgba(0,0,0,.45);
      --ok:#00e676;
      --bad:#ff8b8b;
      --wapp:#25D366;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg); color:var(--text); line-height:1.6;
    }

    /* NAV */
    .navbar{
      display:flex; align-items:center; justify-content:space-between;
      padding:16px 24px; background:#000; color:#fff;
      border-bottom:2px solid var(--primary); position:sticky; top:0; z-index:5;
    }
    .brand{ font-weight:800; color:var(--primary); letter-spacing:.3px }
    .navbar a{
      color:#fff; text-decoration:none; margin-left:14px; padding:8px 10px; border-radius:10px; opacity:.9; transition:.2s;
    }
    .navbar a:hover{ opacity:1; color:var(--primary); background:#0f0f0f }

    .wrap{ max-width:1100px; margin:32px auto; padding:0 16px }

    h1{font-size:1.9rem; margin:0 0 16px}
    .lead{ color:var(--muted); margin:-6px 0 18px }

    /* LAYOUT */
    .grid2{ display:grid; grid-template-columns:2fr 1fr; gap:18px }
    @media (max-width: 900px){ .grid2{ grid-template-columns:1fr } }

    /* CARD */
    .card{
      background:var(--card); border:1px solid var(--line);
      border-radius:var(--radius); padding:18px; box-shadow:var(--shadow);
    }

    .grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:12px }
    .full{ grid-column:1/-1 }

    label{ display:block; font-weight:700; margin-bottom:6px }
    input,select,textarea{
      width:100%; padding:12px; border-radius:12px; border:1px solid var(--line);
      background:#0f0f0f; color:var(--text);
    }
    input::placeholder, textarea::placeholder{ color:#888 }

    .row{ display:flex; align-items:center; gap:10px; margin-top:6px }
    .row input[type="checkbox"]{ width:auto; accent-color:var(--primary) }

    .btn{
      background:var(--primary); border:0; padding:12px 18px; border-radius:12px;
      font-weight:900; cursor:pointer; color:#111; box-shadow:0 8px 20px rgba(255,204,0,.25); transition:.2s;
    }
    .btn:hover{ transform:translateY(-1px) }

    .help{ color:var(--muted); font-size:.9rem }

    /* RESULT */
    .result{
      margin-top:18px; background:#0b0b0b; color:#fff; border:1px solid #1f2937;
      border-radius:18px; padding:18px; display:none
    }
    .result h3{ margin:0 0 8px }
    .mono{ font-variant-numeric:tabular-nums }
    .pill{
      display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid #2a2a2a;
      background:#141414; font-weight:700; font-size:12px
    }
    .ok{ color:var(--ok); border-color:rgba(0,230,118,.25); background:rgba(0,230,118,.07) }
    .bad{ color:var(--bad); border-color:rgba(255,107,107,.25); background:rgba(255,107,107,.08) }

    /* ASIDE GARANTÍAS */
    .bullets{ list-style:none; padding-left:0; margin-top:6px }
    .bullets li{ margin:6px 0 }
    .bullets li::before{ content:"• "; color:var(--primary) }

    /* FEEDBACK */
    .toast{
      position:fixed; bottom:18px; right:18px; background:#111; color:#fff;
      border:1px solid #2a2a2a; padding:12px 14px; border-radius:12px;
      box-shadow:0 8px 24px rgba(0,0,0,.25); display:none
    }
    .toast.show{ display:block }
    .spinner{
      display:none; margin-left:10px; border:3px solid #fff; border-top-color:#111;
      border-radius:50%; width:16px; height:16px; animation:spin .8s linear infinite
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    /* FOOTER & SOCIALS (SVG INLINE) */
    footer{
      background:#0a0a0a; border-top:2px solid var(--primary);
      padding:30px 20px; margin-top:60px; text-align:center;
    }
    .footer-title{ color:var(--primary); font-weight:700; font-size:1.2rem; margin-bottom:8px }
    .social{ display:flex; justify-content:center; gap:20px; margin:14px 0 }
    .social a{
      color:var(--text); text-decoration:none; display:inline-flex; align-items:center; justify-content:center;
      width:38px; height:38px; border-radius:50%; border:1px solid var(--line); background:#0f0f0f; transition:.2s;
    }
    .social a:hover{ border-color:var(--primary); box-shadow:0 0 0 2px rgba(255,204,0,.15) }
    .social a svg{ width:20px; height:20px; fill:#fff }
    .footer-info{ color:var(--muted); font-size:.9rem; margin-top:8px }

    /* WhatsApp Float */
    .whatsapp-float{
      position:fixed; width:56px; height:56px; bottom:24px; right:24px;
      background-color:var(--wapp); color:#fff; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 2px 10px rgba(0,0,0,.4); z-index:100; text-decoration:none; transition:transform .2s;
    }
    .whatsapp-float:hover{ transform:scale(1.08) }
    .whatsapp-float svg{ width:30px; height:30px; fill:#fff }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="brand">Fletes Larga Distancia</div>
    <div>
      <a href="./index.html">Inicio</a>
      <a href="./presupuesto.html">Presupuesto</a>
      <a href="./admin.html">Admin</a>
    </div>
  </nav>

  <main class="wrap">
    <h1>Calcular presupuesto</h1>
    <p class="lead">Presupuesto fijo por viaje. Podés estimar el tiempo y el costo del servicio al instante.</p>

    <div class="grid2">
      <!-- FORM -->
      <section class="card">
        <div class="grid">
          <div>
            <label>Nombre y apellido</label>
            <input id="nombre" placeholder="Juan Pérez"/>
          </div>
          <div>
            <label>Teléfono</label>
            <input id="tel" placeholder="351..."/>
          </div>
          <div>
            <label>Tipo de carga</label>
            <select id="tipo">
              <option value="mudanza">Mudanza</option>
              <option value="puntual">Algo puntual</option>
            </select>
          </div>

          <div class="full">
            <label>Origen (dirección completa)</label>
            <input id="origen" placeholder="Calle y número, Ciudad, País"/>
            <div class="help">Ej: “Colón 100, Córdoba, Argentina”</div>
          </div>
          <div class="full">
            <label>Destino (dirección completa)</label>
            <input id="destino" placeholder="Calle y número, Ciudad, País"/>
          </div>

          <div>
            <label>Fecha</label>
            <input id="fecha" type="date"/>
          </div>
          <div class="row">
            <input id="ayudante" type="checkbox"/>
            <label for="ayudante">¿Necesita ayudante?</label>
          </div>
        </div>

        <div style="margin-top:12px;display:flex;align-items:center;gap:10px">
          <button class="btn" id="btnCalc">Calcular</button>
          <div id="spin" class="spinner"></div>
          <div id="msg" class="help"></div>
        </div>

        <section id="out" class="result"></section>
      </section>

      <!-- ASIDE GARANTÍAS -->
      <aside class="card">
        <h3 style="color:var(--primary);margin-bottom:8px;">¿Por qué elegirnos?</h3>
        <ul class="bullets">
          <li><b>Presupuesto inmediato:</b> en segundos.</li>
          <li><b>Precio fijo por viaje:</b> no por hora ni distancia.</li>
          <li><b>Capacidad:</b> 10m³ / 1.2 toneladas.</li>
          <li><b>Puntualidad y confiabilidad</b> garantizadas.</li>
          <li><b>Córdoba y ciudades vecinas.</b></li>
          <li><b>Atención familiar</b> y personalizada.</li>
        </ul>
        <div class="help" style="margin-top:10px">
          ¿Dudas? Escribinos por WhatsApp y te respondemos al toque.
        </div>
      </aside>
    </div>
  </main>

  <footer>
    <div class="footer-title">Contactanos</div>
    <div class="social">
      <!-- WhatsApp -->
      <a href="https://wa.me/5493516678989" target="_blank" title="WhatsApp" aria-label="WhatsApp">
        <svg viewBox="0 0 32 32"><path d="M16 3C9.372 3 4 8.372 4 15c0 2.115.55 4.103 1.514 5.837L4 29l8.377-1.472A11.91 11.91 0 0 0 16 27c6.628 0 12-5.372 12-12S22.628 3 16 3zm0 2c5.523 0 10 4.477 10 10s-4.477 10-10 10a9.9 9.9 0 0 1-3.987-.832l-.284-.12-.298.052-4.2.738.748-4.104.053-.29-.143-.257A9.9 9.9 0 0 1 6 15c0-5.523 4.477-10 10-10zm5.053 13.873c-.275-.138-1.63-.806-1.875-.898-.244-.092-.422-.138-.6.138-.18.275-.694.956-.85 1.15-.156.193-.312.206-.575.07-.275-.138-1.158-.426-2.213-1.362-.818-.72-1.373-1.61-1.534-1.894-.162-.281-.02-.436.118-.593.122-.122.275-.318.412-.48.138-.162.18-.275.275-.468.092-.193.046-.35-.023-.504-.07-.156-.6-1.448-.825-1.984-.218-.52-.444-.448-.606-.456-.156-.008-.336-.01-.516-.01-.18 0-.47.068-.716.34-.244.275-.932.91-.932 2.222 0 1.312.956 2.58 1.09 2.758.138.18 2.01 3.07 4.85 4.284.68.296 1.21.472 1.63.604.686.218 1.312.187 1.81.114.552-.082 1.69-.69 1.944-1.355.244-.664.244-1.238.172-1.35-.07-.11-.26-.18-.55-.32z"/></svg>
      </a>
      <!-- Instagram -->
      <a href="https://www.instagram.com/fletes_largadistancia" target="_blank" title="Instagram" aria-label="Instagram">
        <svg viewBox="0 0 24 24"><path d="M12 2.2c3.2 0 3.6 0 4.9.1 1.2.1 1.9.2 2.3.4.6.2 1 .4 1.5.9.5.5.7.9.9 1.5.2.4.3 1.1.4 2.3.1 1.3.1 1.7.1 4.9s0 3.6-.1 4.9c-.1 1.2-.2 1.9-.4 2.3-.2.6-.4 1-.9 1.5-.5.5-.9.7-1.5.9-.4.2-1.1.3-2.3.4-1.3.1-1.7.1-4.9.1s-3.6 0-4.9-.1c-1.2-.1-1.9-.2-2.3-.4-.6-.2-1-.4-1.5-.9-.5-.5-.7-.9-.9-1.5-.2-.4-.3-1.1-.4-2.3C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.9c.1-1.2.2-1.9.4-2.3.2-.6.4-1 .9-1.5.5-.5.9-.7 1.5-.9.4-.2 1.1-.3 2.3-.4C8.4 2.2 8.8 2.2 12 2.2m0-1.7C8.7.5 8.3.5 7 .6 5.7.7 4.8.9 4.1 1.2c-.8.3-1.5.7-2.2 1.4C1.3 3.2.9 3.9.6 4.7c-.3.7-.5 1.6-.6 2.9C0 8.8 0 9.3 0 12s0 3.2.1 4.5c.1 1.3.3 2.2.6 2.9.3.8.7 1.5 1.4 2.2.7.7 1.4 1.1 2.2 1.4.7.3 1.6.5 2.9.6 1.3.1 1.8.1 4.5.1s3.2 0 4.5-.1c1.3-.1 2.2-.3 2.9-.6.8-.3 1.5-.7 2.2-1.4.7-.7 1.1-1.4 1.4-2.2.3-.7.5-1.6.6-2.9.1-1.3.1-1.8.1-4.5s0-3.2-.1-4.5c-.1-1.3-.3-2.2-.6-2.9-.3-.8-.7-1.5-1.4-2.2-.7-.7-1.4-1.1-2.2-1.4-.7-.3-1.6-.5-2.9-.6C15.2.5 14.7.5 12 .5z"/><path d="M12 5.8A6.2 6.2 0 1 0 12 18.2 6.2 6.2 0 1 0 12 5.8zm0 10.2A4 4 0 1 1 12 8a4 4 0 0 1 0 8z"/><circle cx="18.4" cy="5.6" r="1.4"/></svg>
      </a>
     <!-- Correo (3 opciones: mailto, Gmail y copiar) -->
<span class="email-wrap" style="display:inline-flex; gap:8px; align-items:center;">
  <!-- Icono mailto -->
  <a href="https://mail.google.com/mail/?view=cm&fs=1&to=fletesjavier@gmail.com&su=Consulta%20desde%20la%20web&body=Hola%20Javier%2C%20quiero%20pedir%20un%20presupuesto%20para%20un%20flete."
     target="_blank" rel="noopener" title="Correo">
    <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5L4 8V6l8 5 8-5v2z"/></svg>
  </a>

 
</span>

      <!-- Teléfono -->
      <a href="tel:+5493516678989" title="Llamar" aria-label="Teléfono">
        <svg viewBox="0 0 24 24"><path d="M6.6 10.8a15.1 15.1 0 0 0 6.6 6.6l2.2-2.2c.3-.3.8-.4 1.2-.2 1.3.5 2.7.8 4.1.8.7 0 1.2.5 1.2 1.2V21c0 .7-.5 1.2-1.2 1.2C10.4 22.2 1.8 13.6 1.8 2.4 1.8 1.7 2.3 1.2 3 1.2H6c.7 0 1.2.5 1.2 1.2 0 1.4.3 2.8.8 4.1.1.4 0 .9-.3 1.2L6.6 10.8z"/></svg>
      </a>
    </div>
    <div class="footer-info">
      © 2025 Fletes Larga Distancia · Córdoba, Argentina <br/>
      Atención rápida, confiable y con presupuesto inmediato.
    </div>
  </footer>



  <script>
    // ⚙️ CONFIG: Cambiá si corre en otro host/puerto
    const API_BASE = "http://127.0.0.1:8000";

    const $ = (id) => document.getElementById(id);
    const showToast = (m)=>{
      const t=$("toast"); if(!t) return;
      t.textContent=m; t.classList.add("show");
      setTimeout(()=>t.classList.remove("show"), 2200)
    };

    // Inline toast fallback (en caso de que no exista el div)
    (function ensureToast(){
      if(!document.getElementById("toast")){
        const d=document.createElement("div");
        d.id="toast"; d.className="toast";
        document.body.appendChild(d);
      }
    })();

    function onLoading(state){
      $("btnCalc").disabled = state;
      const spin = $("spin");
      if(spin) spin.style.display = state ? "inline-block" : "none";
      const msg = $("msg");
      if(msg) msg.textContent = state ? "Calculando..." : "";
    }

    $("btnCalc").onclick = async () => {
      const payload = {
        nombre_cliente: $("nombre").value.trim(),
        telefono: $("tel").value.trim(),
        tipo_carga: $("tipo").value,
        origen: $("origen").value.trim(),
        destino: $("destino").value.trim(),
        fecha: $("fecha").value || null,
        ayudante: $("ayudante").checked
      };

      // Validación mínima
      if(!payload.nombre_cliente || !payload.telefono || !payload.origen || !payload.destino){
        showToast("Completá nombre, teléfono, origen y destino.");
        return;
      }

      onLoading(true);
      try{
        const res = await fetch(`${API_BASE}/api/quote`, {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify(payload)
        });
        const data = await res.json();

        if(!res.ok){
          const detail = data?.detail || "Error interno. Revisá direcciones o la conexión.";
          throw new Error(detail);
        }

        const q = data.quote;
        $("out").style.display = "block";
        $("out").innerHTML = `
          <h3>Resultado</h3>
          <p><b>Cliente:</b> ${q.nombre_cliente} <span class="pill">${q.telefono}</span></p>
          <p><b>Tipo:</b> ${q.tipo_carga}</p>
          <p><b>Origen → Destino:</b> ${q.origen} → ${q.destino}</p>
          <p><b>Fecha:</b> ${q.fecha || "-"}</p>
          <p>
            <b>Distancia:</b> <span class="mono">${q.dist_km} km</span> —
            <b>Manejo:</b> <span class="mono">${q.tiempo_viaje_min} min</span> —
            <b>Servicio:</b> <span class="mono">${q.tiempo_servicio_min} min</span>
          </p>
          <p>
            <b>Costos:</b>
            tiempo $${(q.costo_tiempo||0).toLocaleString("es-AR")} +
            combustible $${(q.costo_combustible||0).toLocaleString("es-AR")}
            ${q.costo_ayudante ? `+ ayudante $${q.costo_ayudante.toLocaleString("es-AR")}` : ``}
          </p>
          <h2 style="margin:8px 0 6px;color:var(--primary)">Total estimado: $ ${q.monto_estimado?.toLocaleString("es-AR")}</h2>
          <div class="pill ${q.estado==='confirmado'?'ok':''}">Estado: ${q.estado}</div>
          <div class="help" style="margin-top:8px">Guardá este ID por si querés consultar: <span class="mono">${q.id}</span></div>
        `;
        showToast("Presupuesto calculado ✅");
      }catch(e){
        $("out").style.display = "block";
        $("out").innerHTML = `
          <h3>Error</h3>
          <p class="pill bad">${e.message}</p>
          <p class="help">Si el error es de geocodificación/ruta, probá detallar más las direcciones (calle + número + ciudad + país).</p>
        `;
        showToast("No se pudo calcular");
      }finally{
        onLoading(false);
      }
    };
  </script>
  <script>
    // Toast liviano
    (function ensureToast(){
      if(!document.getElementById("toast")){
        const d=document.createElement("div");
        d.id="toast";
        d.style.cssText="position:fixed;bottom:18px;right:18px;background:#111;color:#fff;border:1px solid #2a2a2a;padding:12px 14px;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.25);display:none;z-index:9999";
        document.body.appendChild(d);
      }
    })();
    function showToast(msg){ 
      const t=document.getElementById("toast"); 
      t.textContent=msg; 
      t.style.display="block"; 
      setTimeout(()=>t.style.display="none", 2000); 
    }

    async function copyEmail(email){
      try{ 
        await navigator.clipboard.writeText(email); 
        showToast("Email copiado"); 
      }catch{ 
        showToast(email); 
      }
    }
  </script>
</body>
</html>
